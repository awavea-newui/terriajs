// Save 1px for drop zone
$now-viewing-margin: $padding-small - 1px;

.now-viewing{
  .workbench__inner.is-now-viewing &{
    @media screen and (max-width: $sm){
      position: fixed;
      left: 0;
      width: 100%;
      top: $sm-logo-height;
      bottom: $input-height;
    }
  }

  &__remove {
    .btn.btn-remove {
      display: inline-block;
      padding-right: 5px;
      text-transform: capitalize;
    }

    .icon-remove {
      display: inline-block;
    }
  }
}

.now-viewing__header{
  @extend .sm-show;
  @extend .list-reset;
  @extend .clearfix;
  .label, .btn{
    line-height: 1;
    text-transform: uppercase;
    font-size: $font-size-small;
  }

  li{
    display: inline-block;
    float: left;
    &:last-child{
      float: right;
    }
  }
}

// Now viewing
//
// .is-open - now viewing open state
//
// Markup:
// <ul class='now-viewing__content'>
// <li class='now-viewing__item {{modifier_class}}'>
//   <ul class ="now-viewing__item__header">
//     <li><button class="btn btn--drag">National Broadband</button></li>
//     <li><button class='btn btn--toggle'></button></li>
//   </ul>
//   <div class ="now-viewing__item__inner">
//     <ul class="now-viewing__item__control">
//        <li class='zoom'><button title="Zoom in data" class="btn">Zoom To</button></li>
//        <li class='info'><button class='btn' title='info'>info</button></li>
//        <li class='remove'><button title="Remove this data" class="btn">Remove</button></li>
//        <li class='visibility'><button title="Data show/hide" class='btn btn--visibility '></button></li>
//     </ul>
//     <div class="now-viewing__item__opacity">
//       <label htmlFor="opacity">Opacity: </label>
//       <input type='range' name='opacity' min='0' max='1' step='0.01' />
//     </div>
//     <div class="now-viewing__item__legend">
//       No legend to show
//     </div>
//   </div>
//   </li>
// </ul>
//
// Style guide: Component.now-viewing

.kss-modifier__example{
  .now-viewing__item{
    width: 300px;
  }
}

.now-viewing__content,
.now-viewing__item__header,
.now-viewing__item__control
{
  @extend .list-reset;
}

.now-viewing__item{
  @include greybox();
  color: #fff;
  font-family: $font-pop;
  margin: $now-viewing-margin/2 0;
  &.is-dragging{
    opacity: 0.5;
    .now-viewing__header{
      display: none!important;
    }
    .now-viewing__item-inner{
      display: none!important;
    }
  }
  .now-viewing__item__inner{
    display: none;
    padding: $padding;
  }
  &.is-open .now-viewing__item__inner{
    display: block;
  }
}

.now-viewing__item__header{
  @extend .clearfix;
  width: 100%;
  li:first-child{
    @extend .col;
    @extend .col-1;
  }
  li:nth-child(2){
    @extend .col;
    @extend .col-10;
  }

  li:last-child{
    @extend .col;
    @extend .col-1;
  }
  .btn{
    width: 100%;
  }
  .btn--toggle{
      text-align: center;
  }
  .btn--toggle.is-open{
    @media screen and (min-width: $sm){
      padding-left: 8px;
    }
  }
  .now-viewing__item.is-open & {
  border-bottom: 1px solid $border-color;
  }
}

.now-viewing__item__control{
  @extend .clearfix;
  margin: 0px -10px;
  height: 20px;
  position: relative;

  li{
    display: inline-block;
    position: absolute;
    padding: 0 $padding;
  }

  .info {
    left: 33%;
    padding: 0 5%;
  }

  .remove {
    right: 0;

    .icon-remove {
      display: inline-block;
      vertical-align: -1px;
    }

    .btn {
      display: inline-block;
      margin-right: 5px;
    }
  }

  .info{
    border-left: 1px solid $border-color;
    border-right: 1px solid $border-color;
  }
  .btn{
    padding: 0;
    font-size: $font-size-mini;
    &.btn--visibility{
      font-size: $font-size-small;
    }
  }
}
.now-viewing__item__opacity{
  padding: $padding 0;
  border-bottom: 1px solid $border-color;
  text-transform: uppercase;
  font-size: $font-size-mini;
  label{
    margin-right: $padding-small;
  }
}

.now-viewing__item__legend{
  a, img{
    display: block;
  }
  padding: $padding 0 0 0;
}

.now-viewing{
  .drop-zone.is-active{
    height: calc(#{$input-height} + #{$padding});
  }
  .drop-zone{
    height: 1px;
  }
}

//Legend
//

.legend{
  @extend .clearfix;
  @extend .list-reset;
  li{
    display: block;
  }
}

.legend--svg{
  text{
    fill: #fff;
  }
  .tick-mark{
    stroke: #fff;
  }
  svg{
    width: 100%;
    display: block;
    > rect{
      width: 100%;
      fill: rgba(#fff, 0.15);
    }
  }
}

// Temp
// Voldemort

.now-viewing__item__voldemort{
  padding: $padding 0 0 0;
  .voldemort__inner{
    padding: 0 $padding;
    background: $overlay;
  }
  ul{
    @extend .list-reset;
    @extend .clearfix;
  }
  .has-children{
    > span{
      text-transform: uppercase;
    }
  }
  .voldemort__children {
    > ul{
      display: none;
    }
    &.is-open{
      > ul{
        display: block;
      }
    }
  }
}

.now-viewing__item__short-report{
  padding: $padding;
}

.voldemort__children__header{
  @extend .flex;
  span, .btn{
    padding: $padding-small 0;
  }
  span{
    width: 100%;
    line-height: 22px;
    }
  .btn{
    width: 30px;
    &:before{
      font-size: 1.2rem;
    }
  }
}

.btn--voldemort-unique-active{
  @extend .btn--radio-on;
}

.btn--voldemort-unique-inactive{
  @extend .btn--radio-off;
}

.btn--voldemort-multiple-active{
  @extend .btn--checkbox-on;
}

.btn--voldemort-multiple-inactive{
  @extend .btn--checkbox-off;
}

.now-viewing__item__legend{
  font-size: 12px;
}

.now-viewing__item__short-report{
  .collapsible-header {
    color: $color-secondary;
    .btn--toggle {
      padding-left: 0;
    }
  }
}


